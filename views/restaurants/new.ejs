<% layout('layouts/boilerplate') %>
 <div class="row">
   <h1 class="text-center">New Restaurant</h1>
   <div class="col-6 offset-3">
    <form action="/restaurants" method="POST" novalidate class="validated-form" enctype="multipart/form-data" id="newRestaurantForm">
      <div class="mb-3">
        <label class="form-label" for="title">Title</label>
        <input class="form-control" type="text" id="title" name="restaurant[title]" required>
        <div class="valid-feedback"> Looks good!</div>
      </div>
      <div class="mb-3">
        <label class="form-label" for="location">Location</label>
        <input class="form-control" type="text" id="location" name="restaurant[location]" required>
        <div class="valid-feedback"> Looks good!</div>
      </div>
      <div class="mb-3">
        <label class="form-label" for="price">Average Meal Price</label>
        <div class="input-group mb-3">
          <span class="input-group-text" id="price-label">â‚¬</span>
          <input type="text" class="form-control" id="price" name="restaurant[price]" placeholder="0.00" aria-label="price" aria-describedby="price-label" required>
          <div class="valid-feedback"> Looks good!</div>
        </div>
      </div>
      <div class="mb-3"> 
        <label for="formFileMultiple" class="form-label">Upload Images: </label>
        <input class="form-control" type="file" name="image" id="formFileMultiple" multiple required>
        <div class="invalid-feedback"> Image required to add a new Restaurant!</div>

      </div>
      <div class="mb-3">
        <label class="form-label" for="description">Description</label>
        <textarea class="form-control" type="text" id="description" name="restaurant[description]" required></textarea>
        <div class="valid-feedback"> Looks good!</div>
      </div>
      <div class="mb-3">
        <button class="btn btn-success">Add Restaurant</button>
      </div>
    </form>
    <a href="/restaurants"> Back To All Restaurants</a>
   </div>
 </div>

 <script>
      let newRestaurantForm = document.getElementById('newRestaurantForm');

      function hasExtension(inputID, exts) {
      var fileName = document.getElementById(inputID).value;
      return (new RegExp('(' + exts.join('|').replace(/\./g, '\\.') + ')$', "i")).test(fileName);
       }
       
      newRestaurantForm.addEventListener('submit', function(event) {
      let imageUploads       = document.querySelector('#formFileMultiple').files.length;
      if( imageUploads > 6){
        event.preventDefault();
        return alert('Sorry! Only 6 images per Restaurant are allowed.');
      } else if ( imageUploads === 0) {
        event.preventDefault();
        return alert('Sorry! A Restaurant must contain at least one Image.');
      } else if (!hasExtension('formFileMultiple', ['.jpg', '.jpeg', '.png'])) {
        event.preventDefault();
        return alert('Sorry! A Restaurant only accepts JPG, JPEG and PNG Images');
      }
    });
 </script>

